# Rio Controller Configuration
# Example configuration for 32-bit Raspberry Pi with Strobe-Centric Control
#
# This configuration is for a Raspberry Pi running 32-bit Raspberry Pi OS
# with only the strobe module connected. Uses strobe-centric control mode
# compatible with firmware that supports software trigger mode.
#
# IMPORTANT: This mode works only on 32-bit Raspberry Pi OS because it requires
# the picamera package, which is 32-bit only. It has been replaced by camera-centric
# mode (with new strobe chip firmware) for better synchronization, but this mode
# works perfectly fine if you already have a working 32-bit system.
#
# Usage:
#   1. Set environment variable: export RIO_STROBE_CONTROL_MODE=strobe-centric
#   2. Run: python main.py
#   3. Or edit software/config.py to set default mode
#
# Environment Variables (set before running):
#   export RIO_STROBE_CONTROL_MODE=strobe-centric
#   export RIO_SIMULATION=false

# Global simulation mode
# Set to false for hardware operation
simulation: false

# Camera configuration (32-bit Raspberry Pi Camera V2)
# Camera sensor: Sony IMX219, 3280 × 2464 pixels (8 megapixels)
# https://www.raspberrypi.com/documentation/accessories/camera.html#camera-module-2
camera:
  type: rpi              # Use "rpi" for 32-bit Pi Camera V2 (picamera package)
  # NOTE: Display resolution can now be adjusted via the web interface UI
  # Default resolution shown below (640×480), can be changed in Camera Configuration tab
  # Available presets: 640×480, 800×600, 1024×768, 1280×960, 1920×1080
  # Full sensor resolution (3280×2464) available for snapshots via UI
  width: 640             # Default display width (can be changed in UI)
  height: 480            # Default display height (can be changed in UI)
  fps: 30                # Default framerate (automatically optimized via strobe timing)
  # Note: Resolution settings in config files serve as initial defaults only
  # Once the application is running, resolution can be changed via web interface
  # Framerate is automatically calculated from strobe timing and optimized via "Optimize" button

# Strobe configuration (strobe-centric control mode)
strobe:
  port: 24               # SPI device select port (GPIO pin 24, BOARD numbering)
  reply_pause_s: 0.1     # SPI reply pause time (100ms delay for PIC microcontroller to process commands)
  control_mode: strobe-centric  # Strobe-centric control (software trigger)
  trigger_gpio_pin: 18   # GPIO pin for trigger signal (BCM numbering, optional in strobe-centric mode)
  # Strobe-centric mode: Strobe timing controls camera exposure
  # The PIC microcontroller runs its internal timer and triggers strobe based on software timing
  # Camera exposure is synchronized to strobe period

# SPI configuration
# These values come from the hardware design and previous working implementations
spi:
  bus: 0                 # SPI bus number (SPI0 on Raspberry Pi)
  mode: 2                # SPI mode (clock polarity and phase)
  speed_hz: 30000        # SPI communication speed (30 kHz - slow for reliable PIC communication)
  # SPI ports (GPIO pins used for device selection, BOARD numbering):
  #   - Strobe: Port 24
  #   - Flow: Port 26 (not used in this configuration)
  #   - Heater 1: Port 31 (not used in this configuration)
  #   - Heater 2: Port 33 (not used in this configuration)
  #   - Heater 3: Port 32 (not used in this configuration)
  #   - Heater 4: Port 36 (not used in this configuration)

# Notes:
# - Firmware requirement: Must use firmware compatible with software trigger mode (strobe-centric)
# - Camera must be enabled: sudo raspi-config -> Interface Options -> Camera -> Enable
# - Test camera: raspistill -o test.jpg
# - SPI must be enabled: sudo raspi-config -> Interface Options -> SPI -> Enable
# - Reply pause (0.1s) gives PIC time to process commands; this limits SPI communication to ~10 commands/second
#   which is sufficient for configuration and status updates (not used during high-speed imaging)
